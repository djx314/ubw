在这篇文章里, 我们新建一个类型系统模型, 用它来表示清水装入水桶的过程, 或者可以解释为江河汇入大海, 海水满溢流入归墟的过程.

我们来看看代码演示部分

type 水尺  = 初始水尺#下一重#下一重#下一重#下一重
type 大海0 = 大海之初#加水[Int]#加水[String]

type 舀水1 = 水尺#检验[大海0]
type 大海1 = 舀水1#目前舀水#舀[大海0, String]
val 大海1: 大海之初#加水[Int]#加水[String]#加水[String] = (throw new Exception("ii")): 大海1

type 舀水2 = 水尺#检验[大海1]
type 大海2 = 舀水2#目前舀水#舀[大海1, Int]
val 大海2: 大海之初#加水[Int]#加水[String]#加水[String]#加水[Int] = (throw new Exception("ii")): 大海2

type 舀水3 = 水尺#检验[大海2]
type 大海3 = 舀水3#目前舀水#舀[大海2, Long]
val 大海3: 大海之初#加水[Int]#加水[String]#加水[String]#加水[Int]#加水[Long] = (throw new Exception("ii")): 大海3

type 舀水4 = 水尺#检验[大海3]
type 大海4 = 舀水4#目前舀水#舀[大海3, Short]
val 大海4: 大海之初#加水[Int]#加水[String]#加水[String]#加水[Int]#加水[Long] = (throw new Exception("ii")): 大海4

type 舀水5 = 水尺#检验[大海4]
type 大海5 = 舀水5#目前舀水#舀[大海4, String]
val 大海5: 大海之初#加水[Int]#加水[String]#加水[String]#加水[Int]#加水[Long] = (throw new Exception("ii")): 大海5

这是一段没有运行价值的代码，可以看到, 大海没有满水的时候水是正常加进海中的，满水之后就没有再装进更多的水了，而什么时候满水在一开始就决定了，这也符合日常逻辑。

但这并不能完整地表示水满了的情况，水满了之后水只会不经过大海直接汇入归墟，这与现实不符。

所以还有 version2,

在一个 70 毫升的大雨中漫步期间, 我想出了第二个实现(滑稽), 下面是效果代码:

type 测试水尺 = 初始水尺#下一重#下一重#下一重
type 大海0  = 大海之初#加水[Int]#加水[String]#加水[Int]#加水[String]#加水[String]#加水[String]

type 去水1 = 测试水尺#检验[大海0]
type 大海1 = 去水1#目前去水#去[大海0]
val 大海1: 大海之初#加水[Int]#加水[String]#加水[Int]#加水[String]#加水[String] = (throw new Exception("ii")): 大海1

type 去水2 = 测试水尺#检验[大海1]
type 大海2 = 去水2#目前去水#去[大海1]
val 大海2: 大海之初#加水[Int]#加水[String]#加水[Int]#加水[String] = (throw new Exception("ii")): 大海2

type 去水3 = 测试水尺#检验[大海2]
type 大海3 = 去水3#目前去水#去[大海2]
val 大海3: 大海之初#加水[Int]#加水[String]#加水[Int] = (throw new Exception("ii")): 大海3

type 去水4 = 测试水尺#检验[大海3]
type 大海4 = 去水4#目前去水#去[大海3]
val 大海4: 大海之初#加水[Int]#加水[String]#加水[Int] = (throw new Exception("ii")): 大海4

type 去水5 = 测试水尺#检验[大海4]
type 大海5 = 去水5#目前去水#去[大海4]
val 大海5: 大海之初#加水[Int]#加水[String]#加水[Int] = (throw new Exception("ii")): 大海5

可以看出, 水是先累积到超过最高的水线, 然后才流向归墟的(流向归墟的过程在 Runner.scala 中体现), 也就是雨水是先在路面累积然后才流去排水口的, 在水的高度低于满溢的高度之后, 水便不会再溢出, 除非再次重复加水和排水操作.

大家发现, 第一种情况中, 满水之后的操作已经没有了意义, 自然中水根本不可能突然跑去归墟了, 一直都不满的水在生活中对应死水.

在第二种情况中, 水只要到了水尺规定的深度之后就不会再下降, 所以只有水是一直满溢的才会有意义, 这个在生活中对应活水.
